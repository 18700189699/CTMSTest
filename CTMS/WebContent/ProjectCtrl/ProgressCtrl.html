<html>
<head>
<title>测试页面</title>
<meta http-equiv="Content-Type" content="text/html; charset=GB2312">
<link href="../Css/main.css" rel="stylesheet" type="text/css" media="all">
<link href="../Css/cupertino/jquery-ui-1.7.2.custom.css" rel="stylesheet" 
type="text/css" media="all">
<script type="text/javascript" src="../Js/jquery-1.3.2.min.js"></script>
<script type="text/javascript" src="../Js/jquery-ui-1.7.2.custom.min.js"></script>
<script type="text/javascript" src="../Js/ui.datepicker.js"></script>
<script type="text/javascript" src="../Js/ui.core.js"></script>
<script type="text/javascript" src="../Js/Common.js"></script>
<script src="../Js/view/ChooseSample.js" type="text/javascript"></script>
<script  LANGUAGE="JavaScript">
    $(function() {
    $("#DateFrom").datepicker({ dateFormat: 'yy/mm/dd', showOn: 'button', buttonImage: '../images/calendar.gif', buttonImageOnly: true });
    $("#DateTo").datepicker({ dateFormat: 'yy/mm/dd', showOn: 'button', buttonImage: '../images/calendar.gif', buttonImageOnly: true });
    $("#DateFrom2").datepicker({ dateFormat: 'yy/mm/dd', showOn: 'button', buttonImage: '../images/calendar.gif', buttonImageOnly: true });
    $("#DateTo2").datepicker({ dateFormat: 'yy/mm/dd', showOn: 'button', buttonImage: '../images/calendar.gif', buttonImageOnly: true });
    });
	//检索
	function StartSearch()
	{
			form1.action="StudentCtrlL.html?query=1"
			form1.target="_self";
			form1.submit();
	}
	//新建
	function newitem() 
	{
	    window.open("StudentCtrlD.html?query=1&station=&view=new&address=", '', 'resizable=no,width=350,height=200,left=400px,top=350px');
//	    form1.action = "StudentCtrlD.html?query=1&station=&view=new&address=";
//		form1.target="_self";
//		form1.submit();
	}
	//编辑
	function Edit(obj) {
	    var cont = obj.parentElement.parentElement.parentElement.children[1].innerHTML;
	    var BeginDate1 = obj.parentElement.parentElement.parentElement.children[2].innerHTML;
	    var EndDate1 = obj.parentElement.parentElement.parentElement.children[3].innerHTML;
	    var BeginDate2 = obj.parentElement.parentElement.parentElement.children[4].innerHTML;
	    var EndDate2 = obj.parentElement.parentElement.parentElement.children[5].innerHTML;
	    var Progress = obj.parentElement.parentElement.parentElement.children[6].innerHTML;
	    var Hum = obj.parentElement.parentElement.parentElement.children[7].innerHTML;

	    document.getElementById("Cont").value = cont;
	    document.getElementById("DateFrom").value = BeginDate1;
	    document.getElementById("DateTo").value = EndDate1;
	    document.getElementById("DateFrom2").value = BeginDate2;
	    document.getElementById("DateTo2").value = EndDate2;
	    document.getElementById("cmbProgress").value = Progress;
	    document.getElementById("cmbBugCreater").value = Hum;
	    
	    if (document.getElementById("AddProgress").style.display == "none") 
	    {
	        document.getElementById("AddProgress").style.display = "";
	    }
	    document.getElementById("btnAdd").value = "修改";
//	     form1.action=value;
//		form1.target="_self";
//		form1.submit();
	}
	function ResultList() 
	{
	    window.open("ObjectResult.html", '', 'resizable=no,width=450,height=300,left=400px,top=350px');
	}
	function Result(value) 
	{
	    window.open(value, '', 'resizable=no,width=500,height=300,left=400px,top=350px');
	}
	function Detail(value) 
	{
	    window.open(value, '', 'resizable=no,width=500,height=350,left=400px,top=350px');
	}
	function AddPeogress() 
	{

	    if (document.getElementById("btnAdd").value == "修改")
	    {
	        var texts = document.getElementsByTagName("input");
	        for (var i = 0; i < texts.length; i++) {
	            if (texts[i].type == "text") {
	                texts[i].value = "";
	            }
	        }
	        document.getElementById("btnAdd").value = "新增";
	        return;
	    }
	    if (document.getElementById("AddProgress").style.display == "none") {
	        document.getElementById("AddProgress").style.display = "";
	    }
	    else {
	        document.getElementById("AddProgress").style.display = "none";
	    }
	    document.getElementById("btnAdd").value = "新增";
	}
	function init()
	{
	    initcmbProgress();
	    initBugCreater();
	    initcmbProgress1();
	}
</script>
</head>
<body leftmargin="0" topmargin="0" marginwidth="0" marginheight="0" onLoad="init()">
<form id="form1" method="POST">

  <table cellspacing=0 cellpadding=0 width="100%" border=0  align="center">
    <tr>
      <td>
        <table width="100%" border="0" align="center" cellpadding="0" cellspacing="0">
          <tr>
            <td width="2%" height="24"><div align="center"><img 
                                         src="../Images/neiye6_r8_c9.jpg" 
                                         height="11" /></div></td>
            <td width="98%"><font color="#0000FF">当前位置 -> 实训项目管理 -> PM进度管理</font></td>
          </tr>
          <tr>
            <td height="2" colspan="2"><hr size="1" noshade="noshade" /></td>
          </tr>
        </table>
        </td>
    </tr>
    </table>
        <!--任务新增-->
    <table cellspacing=0 cellpadding=0 width="100%" border=0  align="center">
    <span id="stable">

    <tr>
      <td>
      <table class="tbl" cellspacing=1 cellpadding=0 width="100%" border=0  align="left">
          <tr>
           <td colspan=8>
            <table class="tbl" cellspacing=0 cellpadding=2 width="100%" border=0 >
                <tr>
                  <td  width="50%">完成率<select id="cmbProgress1" name="cmbProgress1" class="boxselect"></select></td>
                </tr>
              </table>
              </td>
            </tr>
          <tr>
            <td>
            <table class="tbl"  id="tab" cellspacing=1 cellpadding=0 width="100%" border=0  >
                <tr>
                <th width="2%"><div align="center">序号</div></th>
                  <th width="20%"><div align="center">担当内容</div></th>
                  <!--<th width="40%"><div align="center">地址</div></th>-->
                  <th width="10%"><div align="center">预定开始</div></th>
                  <th width="10%"><div align="center">预定结束</div></th>
                  <th width="10%"><div align="center">实际开始</div></th>
                  <th width="10%"><div align="center">实际结束</div></th>
                  <th width="5%"><div align="center">完成率</div></th>
                  <th width="10%"><div align="center">担当人</div></th>
                  <th width="5%"><div align="center">操作</div></th>
                  <th width="15%"><div align="center">阶段评价</div></th>
                </tr>
				<script type="text/javascript">
				    var JobDept = new Array('DB设计', 'Login画面基本设计书编写', '测试仕样书做成', '单体测试');
				    var BeginY = new Array('2009-12-18', '2009-3-12', '2009-6-12', '2009-8-12');
				    var EndY = new Array('2009-3-12', '2009-6-12', '2009-8-12', '2009-9-12');
				    var BeginS = new Array('2009-3-12', '2009-7-12', '2009-8-12', '2009-9-12');
				    var EndS = new Array('2009-3-12', '2009-6-12', '2009-9-12', '2009-10-12');
				    var Progress = new Array('95%', '85%', '65%', '10%');
				    var Human = new Array('上官玉', '周星星', '雷人王', '上官玉');
				    var SSID = new Array('00001', '00201', '00003', '00004');
				    for (var i = 0; i < JobDept.length; i++)
				  {
				      document.write(" <tr>");
				      document.write("<td width=\"2%\"   align=center>" + (i + 1) + "</td>");
				        document.write("<td width=\"20%\"   align=center>" + JobDept[i] + "</td>");
				        document.write("<td width=\"10%\" class=\"niu\"  align=center>" + BeginY[i] + "</td>");
				        document.write("<td width=\"10%\" class=\"niu\"  align=center>" + EndY[i] + "</td>");
				        document.write("<td width=\"10%\" class=\"niu\" align=center>" + BeginS[i] + "</td>");
				        document.write("<td width=\"10%\" class=\"niu\" align=center>" + EndS[i] + "</td>");
				        document.write("<td width=\"5%\" class=\"prog\" align=center>" + Progress[i] + "</td>");
				        document.write("<td width=\"10%\" class=\"hum\" align=center>" + Human[i] + "</td>");
				        document.write("<td width=\"5%\"><div align=\"center\"><img onClick = 'Edit(this)' src='../img/xedit.gif' alt='编辑'>"
									   + "&nbsp;&nbsp;<img onClick = 'Delete(\"" + JobDept[i] + "\")' src='../img/delete.gif' alt='删除'></div></td>");
				        document.write("<td width=\"15%\" align=center><img id=\"Photo\" src=\"../img/pm_pr.gif\" onClick='Detail(\"StageResult.html?query=1&view=add&name=" + Human[i] + "&SSID=" + SSID[i] + "\")' value=\"新增\"/>"
				        + "&nbsp;&nbsp;<img id=\"Photo\" src=\"../img/xedit.gif\" onClick='Detail(\"StageResult.html?query=1&view=edit&name=" + Human[i] + "&SSID=" + SSID[i] + "\")' value=\"编辑\"/>"
				        + "&nbsp;&nbsp;<img id=\"Photo\" src=\"../img/look.gif\" onClick='Detail(\"StageResult.html?query=1&view=view&name=" + Human[i] + "&SSID=" + SSID[i] + "\")' value=\"查看\"/>"
				        + "</td>");
				        document.write("</tr>");
				 }
				  </script>
				</table>
				</td>
				</tr>
            <tr>
           <td colspan=8>
            <table class="tbl" cellspacing=0 cellpadding=2 width="100%" border=0 >
                <tr>
                  <td  width="50%"><input id="btnAdd1" class="button" type="button" value="新增任务" onclick="AddPeogress();"/></td>
                  <td  width="50%" align="right"><input id="Excel" class="button" type="button" value="导出Excel"/></td>
                </tr>
              </table>
                <div id="AddProgress" style="display: none">
<table class="tbl" cellspacing=1 width="100%" cellpadding=0 border=0>
          <tr>
            <td width="10%">担当内容:</td>
            <td width="20%" colspan=3><input type="text" id="Cont" value="" 
              size="30"/><font Color='Red'>*</font></td>
          </tr>
          <tr>
              <td width="10%" >预订时间:</td>
            <td width="50%">
            <input type="text" id="DateFrom" value="" size="30"/><font Color='Red'>*</font> ～
            <input type="text" id="DateTo" value="" size="30"/><font Color='Red'>*</font>
            </td>
          </tr>
          <tr>
              <td width="10%" >实际时间:</td>
            <td width="50%">
            <input type="text" id="DateFrom2" value="" size="30"/> ～
            <input type="text" id="DateTo2" value="" size="30"/>
            </td>
          </tr>
          <tr>
              <td width="10%" >完成率:</td>
            <td width="50%">
            <!--<input type="text" id="Progress" value="" size="30"/>%-->
            <select id="cmbProgress" name="cmbProgress" class="boxselect">
            </td>
          </tr>
          <tr>
              <td width="10%" >担当人:</td>
            <td width="50%">
            <select id="cmbBugCreater" name="cmbBugCreater" class="boxselect"><font Color='Red'>*</font>
            </td>
          </tr>
          <tr>
              <td width="10%" >成果物上传:</td>
            <td width="50%">
            <input type="file" id="file" value="" size="30"/>
            </td>
          </tr>
          <tr>
            <td colspan=5><input id="btnAdd" class="button" type="button" onclick="" value="新增" name="search"/>
			<input id="btnsearch" class="button" type="button" onClick="AddPeogress();" value="取消" name="btnnew"/></td>
          </tr>
        </table>
</div>
              </td>
            </tr>
          </span>
        </table>
</form>
</body>
</html>

